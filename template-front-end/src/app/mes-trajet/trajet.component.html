<div class="row">

  <div class="col-sm-12">
    <app-card [title]="'Mes Trajets'" [classHeader]="true">
      <span class="code-header">All Trajet</span>
      <table _ngcontent-c6=""  class="table table-hover" >
        <thead _ngcontent-c6="">
       <tr>

          <th class="text-center priority-7" style="width: 8%;"> Lieu Depart </th>
          <th class="text-center priority-9" style="width: 5%;">Lieu Arrive</th>
          <th class="text-center priority-2" style="width: 5%;"> Date Depart </th>
          <th class="text-center priority-3" style="width: 5%;"> Date Arrive</th>
          <th class="text-center priority-3" style="width: 5%;"> Nombre Place</th>
          <th class="text-center priority-3" style="width: 5%;"> PRIX  </th>
          <th class="text-center priority-3" style="width: 5%;"> Etat </th>
          <th class="text-center priority-3" style="width: 5%;"><button class="btn  btn-outline-primary" (click)="openTrajet(contentTrajetAdd)"><i class="icofont icofont-ui-add"></i>Ajouter Trajet</button></th>
        </tr>
        </thead>
        <tbody _ngcontent-c6="">
        <tr *ngFor="let trajet of trajetData" class='table-data'>

            <td (click)="openTrajetid(contentTrajetLigne,trajet.id);" style="text-align:center">{{trajet.lieu_depart}}</td>
            <td (click)="openTrajetid(contentTrajetLigne,trajet.id);" style="text-align:center">{{trajet.lieu_arrive}}</td>
            <td  (click)="openTrajetid(contentTrajetLigne,trajet.id);" style="text-align:center">{{trajet.date_depart.slice(0,10)}}</td>
            <td  (click)="openTrajetid(contentTrajetLigne,trajet.id);" style="text-align:center">{{trajet.date_arrive.slice(0,10)}}</td>
            <td  (click)="openTrajetid(contentTrajetLigne,trajet.id);" style="text-align:center">{{trajet.nbplace}}</td>
            <td (click)="openTrajetid(contentTrajetLigne,trajet.id);" style="text-align:center">{{trajet.prix}} MAD</td>
            <td  (click)="openTrajetid(contentTrajetLigne,trajet.id);" style="text-align:center">
                <div *ngIf="trajet.etats == 0">
                    <span class="label label-inverse-info">Disponible</span>
                </div>
                <div *ngIf="trajet.etats == 1">
                    <span class="label label-inverse-danger">Non Disponible(Fin)</span>
                </div>
            </td>
            <td style="text-align:center">
                <button type="button" class="btn btn-outline-success" (click)="openTrajet(contentTrajetAdd)"><i class="icofont icofont-edit"></i></button>
                <button type="button" class="btn btn-outline-danger" (click)="opensm(contentTrajetDelete)"><i class="icofont icofont-ui-delete"></i></button>
               <button  *ngIf="trajet.etats == 0" type="button" class="btn btn-outline-info" (click)="opensm(contentTrajetClose)"><i class="icofont icofont-ui-block"></i></button>
            </td>

            <ng-template #contentTrajetLigne let-c="close" let-d="dismiss">
                <div class="modal-header" style="background-color: #00AEEF">
                    <h4 class="modal-title" style="color: white">Trajet</h4>
                    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <dl class="row">
                        <dt class="col-sm-3">Lieu Depart</dt>
                        <dd class="col-sm-3"> {{ trajet.lieu_depart }}</dd>
                        <dt class="col-sm-3">lieu Arrive</dt>
                        <dd class="col-sm-3"> {{ trajet.lieu_arrive }}</dd>
                        <br><br>
                        <dt class="col-sm-3">Date Depart</dt>
                        <dd class="col-sm-3"> {{ trajet.date_depart.slice(0,10) }}</dd>
                        <dt class="col-sm-3">Dae arrive</dt>
                        <dd class="col-sm-3"> {{ trajet.date_arrive.slice(0,10) }}</dd>
                        <br><br>

                        <dt class="col-sm-3">PRIX</dt>
                        <dd class="col-sm-3">
                            <div *ngIf="trajet.prix == null">
                                <span class="label label-inverse-danger">Pas Montant </span>
                            </div>
                            {{ trajet.prix }}</dd>
                        <br><br>
                        <dt class="col-sm-3">Etat</dt>
                        <dd class="col-sm-3">
                            <div *ngIf="trajet.etats == 0">
                                <span class="label label-inverse-info">Disponible</span>
                            </div>
                            <div *ngIf="trajet.etats == 1">
                                <span class="label label-inverse-danger">Non Disponible(Fin)</span>
                            </div>
                        </dd>
                        <dt class="col-sm-3">Description</dt>
                        <dd class="col-sm-3">
                            <div >
                               {{trajet.description}}
                            </div>
                        </dd>

                    </dl>

                    <div _ngcontent-c6="" class="table-responsive">
                        <table _ngcontent-c6="" class="table table-hover">
                            <thead _ngcontent-c6="">
                            <tr _ngcontent-c6="">
                                <th _ngcontent-c6="" style="width: 20%">Nom Prenom</th>
                                <th _ngcontent-c6="" style="width: 20%">Date Reservation</th>
                                <th _ngcontent-c6="" style="width: 20%">Sex</th>
                                <th _ngcontent-c10=""style="width: 20%">Phone</th>
                                <th _ngcontent-c3="" style="width: 3%">Accepte/Rejet</th>

                            </tr>
                            </thead>
                            <tbody _ngcontent-c6="">
                            <tr _ngcontent-c6=""  *ngFor="let ligne of ligneReservationData">

                                <th _ngcontent-c6="" (click)="openTrajet(contentProfile,ligne.id_passager)" >{{ligne.nom}}  {{ligne.prenom}}</th>
                                <td _ngcontent-c6="" (click)="openTrajet(contentProfile,ligne.id_passager)">{{ ligne.date_reservation }}</td>
                                <td _ngcontent-c6="" (click)="openTrajet(contentProfile,ligne.id_passager)">
                                    <div *ngIf="ligne.sex == 'M'">
                                    <span class="label label-inverse-info">Male</span>
                                </div>
                                    <div *ngIf="ligne.sex == 'F'">
                                        <span class="label label-inverse-danger">Female</span>
                                    </div></td >
                                <td _ngcontent-c6="" (click)="openTrajet(contentProfile,ligne.id_passager)">{{ligne.telephone}}</td>
                                <td _ngcontent-c3=""  class="action-icon">


                                    <div *ngIf="ligne.acceptation == 1">
                                    <a _ngcontent-c3="" class="crm-action-delete text-muted text-danger"  (click)="Refus(ligne.idreservation); d('Cross click');" href="javascript:;"><i _ngcontent-c11="" class="icofont icofont-ban"></i></a>&nbsp;&nbsp;&nbsp;
                                    <a _ngcontent-c3="" class="crm-action-success text-muted text-success"  (click)="Acceptation(ligne.idreservation); d('Cross click');" href="javascript:;"><i _ngcontent-c11="" class="icofont icofont-check-alt"></i></a>
                                    </div>
                                    <div *ngIf="ligne.acceptation == 0">
                                        <span class="label label-inverse-danger">Ban</span>&nbsp;&nbsp;&nbsp;
                                        <a _ngcontent-c3="" class="crm-action-success text-muted text-success"  (click)="Acceptation(ligne.idreservation); d('Cross click');" href="javascript:;"><i _ngcontent-c11="" class="icofont icofont-check-alt"></i></a>
                                    </div>
                                    <div *ngIf="ligne.acceptation == 2">
                                        <span class="label label-inverse-success">Accepted</span>&nbsp;&nbsp;&nbsp;
                                        <a _ngcontent-c3="" class="crm-action-delete text-muted text-danger"  (click)="Refus(ligne.idreservation); d('Cross click');" href="javascript:;"><i _ngcontent-c11="" class="icofont icofont-ban"></i></a>
                                    </div>
                                </td>



                                <ng-template #contentProfile let-c="close" let-d="dismiss">
                                    <div class="modal-header" style="background-color: #fffd2d">
                                        <h4 class="modal-title" style="color: white">Profile Passager</h4>
                                        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">

                                        <div>
                                            <ngb-tabset #t="ngbTabset">

                                                <ngb-tab id="tab-selectbyid1" title="Passager">

                                                    <ng-template ngbTabContent>

                                                        <div class="card-body table-border-style">
                                                            <div _ngcontent-c11="" class="table-responsive">

                                                                <table _ngcontent-c11="" class="table table-hover">
                                                                    <tbody _ngcontent-c11="">

                                                                    <tr _ngcontent-c11="">
                                                                        <td _ngcontent-c11="">Nom Prenom</td>
                                                                        <td _ngcontent-c11="">{{ ligne.nom }} {{ ligne.prenom }}</td>
                                                                    </tr>
                                                                    <tr _ngcontent-c11="">
                                                                        <td _ngcontent-c11="">Téléphone</td>
                                                                        <td _ngcontent-c11=""> {{ ligne.telephone }}</td>
                                                                    </tr>

                                                                    <tr _ngcontent-c11="">
                                                                        <td _ngcontent-c11="">Date de naissance</td>
                                                                        <td _ngcontent-c11="">{{ ligne.date_naissance }}</td>
                                                                    </tr>

                                                                    <tr _ngcontent-c11="">
                                                                        <td _ngcontent-c11="">Description Reservation</td>
                                                                        <td _ngcontent-c11="">{{ ligne.description_reservation }}</td>
                                                                    </tr>
                                                                    <tr _ngcontent-c11="">
                                                                        <td _ngcontent-c11="">Description Reservation</td>
                                                                        <td _ngcontent-c11="">

                                                                            <div *ngIf="ligne.acceptation == 0">
                                                                                <span class="label label-inverse-danger">Ban</span>
                                                                            </div>
                                                                            <div *ngIf="ligne.acceptation == 2">
                                                                                <span class="label label-inverse-success">Accepted</span>
                                                                            </div>
                                                                            <div *ngIf="ligne.acceptation == 1">
                                                                                <span class="label label-inverse-info">En cours</span>
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                    <tr _ngcontent-c11="">
                                                                        <td _ngcontent-c11="">Sex</td>

                                                                        <td _ngcontent-c11="">
                                                                            <div *ngIf="ligne.sex == 'M'">
                                                                                <span class="label label-inverse-info">Male</span>
                                                                            </div>
                                                                            <div *ngIf="ligne.sex == 'F'">
                                                                                <span class="label label-inverse-danger">Female</span>
                                                                            </div>
                                                                        </td>
                                                                    </tr>


                                                                    <tr _ngcontent-c11="">
                                                                        <td _ngcontent-c11="">Adresse</td>
                                                                        <td _ngcontent-c11="">{{ ligne.adresse }}</td>
                                                                    </tr>

                                                                    <tr _ngcontent-c11="">
                                                                        <td _ngcontent-c11="">Email</td>
                                                                        <td _ngcontent-c11="">{{ ligne.email }}</td>
                                                                    </tr>

                                                                    <tr _ngcontent-c11="">
                                                                        <td _ngcontent-c11="">Historique</td>
                                                                        <td _ngcontent-c11=""><div class="card-body table-border-style">


                                                                            <div _ngcontent-c11="" class="table-responsive">
                                                                                <table _ngcontent-c11="" class="table">
                                                                                    <thead _ngcontent-c11="" >
                                                                                    <tr _ngcontent-c11="">
                                                                                        <th _ngcontent-c11="">Depart</th>
                                                                                        <th _ngcontent-c11="">Arriver</th>
                                                                                        <th _ngcontent-c11="">Date</th>
                                                                                        <th _ngcontent-c11="">Montant</th>
                                                                                        <th _ngcontent-c11="">accept/reject</th>
                                                                                    </tr>
                                                                                    </thead>
                                                                                    <tbody _ngcontent-c6="">
                                                                                    <tr _ngcontent-c6=""  *ngFor="let ligneHisto of ligneHistoriqueData">

                                                                                        <th _ngcontent-c6="" >{{ligneHisto.lieu_depart}}</th>
                                                                                        <td _ngcontent-c6="" >{{ ligneHisto.lieu_arrive }}</td>
                                                                                        <td _ngcontent-c6="" >{{ ligneHisto.date_reservation }}</td>
                                                                                        <td _ngcontent-c6="" >{{ ligneHisto.prix }}</td>
                                                                                        <td _ngcontent-c6="" >
                                                                                            <div *ngIf="ligneHisto.acceptation == 0">
                                                                                            <span class="label label-inverse-danger">Ban</span>
                                                                                            </div>
                                                                                            <div *ngIf="ligneHisto.acceptation == 2">
                                                                                                <span class="label label-inverse-success">Accepted</span>
                                                                                            </div>
                                                                                            <div *ngIf="ligneHisto.acceptation == 1">
                                                                                                <span class="label label-inverse-info">En cours</span>
                                                                                            </div>
                                                                                        </td>


                                                                                    </tbody>
                                                                                </table>
                                                                            </div>

                                                                        </div></td>
                                                                    </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>

                                                        </div>
                                                        <div class="card-body table-border-style">

                                                            <div _ngcontent-c6="" class="row">
                                                                <div _ngcontent-c6="" class="col-sm-12">
                                                                    <div _ngcontent-c6="" class="table-responsive">
                                                                        <table _ngcontent-c6="" class="table  invoice-detail-table">
                                                                            <thead _ngcontent-c6="">
                                                                            <tr _ngcontent-c6="" class="thead-default">
                                                                                <th _ngcontent-c6="">Description</th>

                                                                            </tr>
                                                                            </thead>
                                                                            <tbody _ngcontent-c6="" >
                                                                            <td _ngcontent-c6="">{{ ligne.description }}</td>

                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div _ngcontent-c6="" class="row">
                                                                <div _ngcontent-c6="" class="col-sm-12">
                                                                    <table _ngcontent-c6="" class="table table-responsive invoice-table invoice-total">
                                                                    </table>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </ng-template>
                                                </ngb-tab>
                                            </ngb-tabset>
                                        </div>



                                    </div>
                                </ng-template>


                            </tr>


                            </tbody>
                        </table>
                        <div class="modal-footer">
                            <button type="submit" value="Submit" class="btn btn-success" (click)="c('Close click')"><i class="icofont icofont-ui-add"></i>Fermer</button>
                        </div>
                    </div>

                </div>


            </ng-template>

            <ng-template #contentTrajetDelete let-c="close" let-d="dismiss">
                <div class="modal-header" style="background-color:red">
                    <h4 class="modal-title" style="color: white">Delete Trajet Ref:{{trajet.id}}</h4>
                    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                   <h4>are you sure about that ?&nbsp;&nbsp;&nbsp;&nbsp; <button type="button" class="btn btn-danger btn-square" (click)="delete(trajet)" (click)="d('Cross click')"><i class="icofont icofont-warning-alt"></i> Supprimer</button> </h4>
                </div>
            </ng-template>

            <ng-template #contentTrajetClose let-c="close" let-d="dismiss">
                <div class="modal-header" style="background-color:cadetblue">
                    <h4 class="modal-title" style="color: white">Close Trajet Ref:{{trajet.id}}</h4>
                    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                   <h4>are you sure about that ?&nbsp;&nbsp;&nbsp;&nbsp; <button type="button" class="btn btn-default" (click)="close(trajet)" (click)="d('Cross click')">Close</button> </h4>
                </div>
            </ng-template>


        </tr>

        </tbody>
      </table>
    </app-card>
  </div>


</div>

<ng-template #contentTrajetAdd let-c="close" let-d="dismiss">
    <div class="modal-header" style="background-color: #2aefb0">
        <h4 class="modal-title" style="color: white">Ajouter Trajet</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">

        <form method="post" action="" [formGroup]="myform" (ngSubmit)="onSubmit(); d('Cross click');" >
            <div class="form-group">

                <label class="col-form-label">Lieu Depart</label>
                <input type="text" class="form-control" formControlName="lieu_depart" ngModel required>


                <label class="col-form-label">Lieu Arrive</label>
                <input type="text" class="form-control" formControlName="lieu_arrive" ngModel required>

                <label class="col-form-label">Date Depart</label>
                <input type="date" class="form-control" formControlName="date_depart" ngModel required>


                <label class="col-form-label">Date Arrive</label>
                <input type="date" class="form-control" formControlName="date_arrive" ngModel required>


                <label class="col-form-label">Prix</label>
                <input type="number" class="form-control" formControlName="prix" ngModel required>

                <label class="col-form-label">Nombre de Place</label>
                <input type="number" class="form-control" formControlName="nbplace" ngModel required>

                <label  class="col-form-label">Description</label>
                <textarea class="form-control" id="description"  formControlName="description" ngModel  ></textarea>

            </div>

            <div class="modal-footer">
                <button class="btn btn-dark" (click)="c('Close click')">Annuler</button>
                <button type="submit" value="Submit" class="btn btn-success" [disabled]="myform.invalid"><i class="icofont icofont-ui-add"></i>Créer Trajet</button>
            </div>
        </form>

    </div>

</ng-template>

<ng2-toasty [position]="position"></ng2-toasty>
